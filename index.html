<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>School Carpool | Safe Rides</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <div class="container">
        <div id="auth-view" class="hidden" style="text-align: center; padding-top: 100px;">
            <h1>🚗 School Carpool</h1>
            <p>Connect with other parents for safer student commutes.</p>
            <button onclick="signIn()" class="btn-primary" style="width: auto; padding: 15px 40px;">Sign in with Google</button>
        </div>

        <div id="dashboard-view" class="hidden">
            <header>
                <div>
                    <h1>School Carpool</h1>
                    <p>Safe rides for students</p>
                </div>
                <button onclick="signOut()" class="btn-outline">Sign Out</button>
            </header>

            <div class="stats-grid">
                <div class="stat-card green"><h3>Available Trips</h3><p id="stat-avail">0</p></div>
                <div class="stat-card blue"><h3>My Rides</h3><p id="stat-rides">0</p></div>
                <div class="stat-card purple"><h3>Driving</h3><p id="stat-driving">0</p></div>
                <div class="stat-card orange"><h3>Total Trips</h3><p id="stat-total">0</p></div>
            </div>

            <div id="driver-actions" class="hidden" style="margin-bottom: 20px;">
                <button onclick="openTripModal()" class="purple" style="color:white">+ Create New Trip</button>
            </div>

            <h2>Available Trips</h2>
            <div id="trips-container" class="trips-grid"></div>
        </div>
    </div>

    <div id="profile-modal" class="modal hidden">
        <div class="modal-content">
            <h2>Complete Your Profile</h2>
            <form id="profile-form">
                <label>Full Name</label>
                <input type="text" id="p-name" required>
                <label>Phone Number</label>
                <input type="tel" id="p-phone" placeholder="+60..." required>
                <label>Gender</label>
                <select id="p-gender" required>
                    <option value="Lelaki">Lelaki</option>
                    <option value="Perempuan">Perempuan</option>
                </select>
                <label>Role</label>
                <select id="p-role" required>
                    <option value="Passenger">Passenger (Find Rides)</option>
                    <option value="Driver">Driver (Offer Rides)</option>
                    <option value="Both">Both</option>
                </select>
                <label>Home Area</label>
                <input type="text" id="p-area" placeholder="e.g., Bandar Baru Bangi" required>
                <button type="submit" class="btn-primary">Save Profile</button>
            </form>
        </div>
    </div>

    <div id="trip-modal" class="modal hidden">
        <div class="modal-content">
            <h2 id="modal-title">Create Trip</h2>
            <form id="trip-form">
                <input type="hidden" id="t-id">
                <input type="text" id="t-title" placeholder="Trip Title" required>
                <input type="text" id="t-start" placeholder="Pickup Point" required>
                <input type="text" id="t-dest" placeholder="Destination School" required>
                <div style="display: flex; gap: 10px;">
                    <input type="date" id="t-date" required>
                    <input type="time" id="t-time" required>
                </div>
                <select id="t-type">
                    <option value="morning">Morning</option>
                    <option value="afternoon">Afternoon</option>
                </select>
                <input type="number" id="t-seats" placeholder="Seats Available" min="1" required>
                <button type="submit" class="btn-primary">Confirm Trip</button>
                <button type="button" onclick="closeModal()" class="btn-outline" style="width:100%; margin-top:10px;">Cancel</button>
            </form>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>